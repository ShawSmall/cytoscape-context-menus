!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cytoscapeContextMenus=t():e.cytoscapeContextMenus=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){let{contextMenus:i}=n(1),s=function(e){e&&e("core","contextMenus",i)};"undefined"!=typeof cytoscape&&s(cytoscape),e.exports=s},function(e,t,n){"use strict";function i(e){return!function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||e.style&&e.style.display||getComputedStyle(e).display}(e)}function s(e){let t="";for(let n=0;n<e.length;n++){t+=e[n],n!==e.length-1&&(t+=" ")}return t}function o(e,t,n){n?e.setAttribute(t,""):e.removeAttribute(t)}function u(e,t,n){void 0===customElements.get(e)&&customElements.define(e,t,{extends:n})}n.r(t),n.d(t,"contextMenus",(function(){return h}));const r={evtType:"cxttap",menuItems:[],menuItemClasses:["cy-context-menus-cxt-menuitem"],contextMenuClasses:["cy-context-menus-cxt-menu"],submenuIndicator:{src:"assets/submenu-indicator-default.svg",width:12,height:12}};function l(e){e.preventDefault(),e.stopPropagation()}class c extends HTMLElement{constructor(e,t,n){super(),super.setAttribute("id",e.id);let i=this._getMenuItemClassStr(n.cxtMenuItemClasses,e.hasTrailingDivider);if(super.setAttribute("class",i),super.setAttribute("title",e.tooltipText||""),e.disabled&&o(this,"disabled",!0),e.image){let t=document.createElement("img");t.src=e.image.src,t.width=e.image.width,t.height=e.image.height,t.style.position="absolute",t.style.top=e.image.y+"px",t.style.left=e.image.x+"px",super.appendChild(t)}if(this.innerHTML+=e.content,this.onMenuItemClick=t,this.data={},this.clickFns=[],this.selector=e.selector,this.show=void 0===e.show||e.show,this.coreAsWell=e.coreAsWell||!1,this.scratchpad=n,void 0===e.onClickFunction&&void 0===e.submenu)throw new Error("A menu item must either have click function or a submenu or both");this.onClickFunction=e.onClickFunction,e.submenu instanceof Array&&this._createSubmenu(e.submenu),super.addEventListener("mousedown",l),super.addEventListener("mouseup",l),super.addEventListener("touchstart",l),super.addEventListener("touchend",l)}bindOnClickFunction(e){this.clickFns.push(e),super.addEventListener("click",e)}unbindOnClickFunctions(){for(let e of this.clickFns)super.removeEventListener("click",e);this.clickFns=[]}enable(){o(this,"disabled",!1),this.hasSubmenu()&&this.addEventListener("mouseenter",this.mouseEnterHandler)}disable(){o(this,"disabled",!0),this.hasSubmenu()&&this.removeEventListener("mouseenter",this.mouseEnterHandler)}hide(){this.show=!1,this.style.display="none"}hasSubmenu(){return this.submenu instanceof d}appendSubmenuItem(e,t){this.hasSubmenu()||this._createSubmenu(),this.submenu.appendMenuItem(e,t)}isClickable(){return void 0!==this.onClickFunction}display(){this.show=!0,this.style.display="block"}removeSubmenu(){this.hasSubmenu()&&(this.submenu.removeAllMenuItems(),this.detachSubmenu())}detachSubmenu(){this.hasSubmenu()&&(this.removeChild(this.submenu),this.removeChild(this.indicator),this.removeEventListener("mouseenter",this.mouseEnterHandler),this.removeEventListener("mouseleave",this.mouseLeaveHandler),this.submenu=void 0,this.indicator=void 0)}_onMouseEnter(e){let t=this.getBoundingClientRect(),n=function(e){e.style.opacity="0",e.style.display="block";let t=e.getBoundingClientRect();return e.style.opacity="1",e.style.display="none",t}(this.submenu),i=t.right+n.width>window.innerWidth,s=t.top+n.height>window.innerHeight;i||s?i&&!s?(this.submenu.style.right=this.clientWidth+"px",this.submenu.style.top="0px",this.submenu.style.left="auto",this.submenu.style.bottom="auto"):i&&s?(this.submenu.style.right=this.clientWidth+"px",this.submenu.style.bottom="0px",this.submenu.style.top="auto",this.submenu.style.left="auto"):(this.submenu.style.left=this.clientWidth+"px",this.submenu.style.bottom="0px",this.submenu.style.right="auto",this.submenu.style.top="auto"):(this.submenu.style.left=this.clientWidth+"px",this.submenu.style.top="0px",this.submenu.style.right="auto",this.submenu.style.bottom="auto"),this.submenu.display()}_onMouseLeave(e){(function({x:e,y:t},n){let i=n.getBoundingClientRect();return e>=i.left&&e<=i.right&&t>=i.top&&t<=i.bottom})({x:e.clientX,y:e.clientY},this.submenu)||this.submenu.hide()}_createSubmenu(e=[]){this.indicator=this.scratchpad.submenuIndicatorGen(),this.submenu=new d(this.onMenuItemClick,this.scratchpad),this.appendChild(this.indicator),this.appendChild(this.submenu);for(let t of e){let e=new c(t,this.onMenuItemClick,this.scratchpad);this.submenu.appendMenuItem(e)}this.mouseEnterHandler=this._onMouseEnter.bind(this),this.mouseLeaveHandler=this._onMouseLeave.bind(this),this.addEventListener("mouseenter",this.mouseEnterHandler),this.addEventListener("mouseleave",this.mouseLeaveHandler)}_getMenuItemClassStr(e,t){return t?e+" cy-context-menus-divider":e}static define(){u("ctx-menu-item",c,"button")}}class d extends HTMLElement{constructor(e,t){super(),super.setAttribute("class",t.cxtMenuClasses),this.style.position="absolute",this.onMenuItemClick=e,this.scratchpad=t}hide(){this.isVisible()&&(this.hideSubmenus(),this.style.display="none")}display(){this.style.display="block"}isVisible(){return"none"!==this.style.display}hideMenuItems(){for(let e of this.children)e instanceof HTMLElement?e.style.display="none":console.warn(e+" is not a HTMLElement")}hideSubmenus(){for(let e of this.children)e instanceof c&&e.submenu&&e.submenu.hide()}appendMenuItem(e,t){if(void 0!==t){if(t.parentNode!==this)throw new Error(`The item with id='${t.id}' is not a child of the context menu`);this.insertBefore(e,t)}else this.appendChild(e);e.isClickable()&&this._performBindings(e)}moveBefore(e,t){if(e.parentNode!==this)throw new Error(`The item with id='${e.id}' is not a child of context menu`);if(t.parentNode!==this)throw new Error(`The item with id='${t.id}' is not a child of context menu`);this.removeChild(e),this.insertBefore(e,t)}removeAllMenuItems(){for(;this.firstChild;){let e=this.lastChild;e instanceof c?this._removeImmediateMenuItem(e):(console.warn("Found non menu item in the context menu: ",e),this.removeChild(e))}}_removeImmediateMenuItem(e){if(!this._detachImmediateMenuItem(e))throw new Error(`menu item(id=${e.id}) is not in the context menu`);e.detachSubmenu(),e.unbindOnClickFunctions()}_detachImmediateMenuItem(e){if(e.parentNode===this){if(this.removeChild(e),this.children.length<=0){let e=this.parentNode;e instanceof c&&e.detachSubmenu()}return!0}return!1}_performBindings(e){let t=this._bindOnClick(e.onClickFunction);e.bindOnClickFunction(t),e.bindOnClickFunction(this.onMenuItemClick)}_bindOnClick(e){return()=>{let t=this.scratchpad.currentCyEvent;e(t)}}static define(){u("menu-item-list",d,"div")}}class a extends d{constructor(e,t){super(e,t),this.onMenuItemClick=t=>{l(t),this.hide(),e()}}removeMenuItem(e){let t=e.parentElement;t instanceof d&&this.contains(t)&&t._removeImmediateMenuItem(e)}appendMenuItem(e,t){this.ensureDoesntContain(e.id),super.appendMenuItem(e,t)}insertMenuItem(e,{before:t,parent:n}={}){if(this.ensureDoesntContain(e.id),void 0!==t){if(!this.contains(t))throw new Error(`before(id=${t.id}) is not in the context menu`);{let n=t.parentNode;if(!(n instanceof d))throw new Error(`Parent of before(id=${t.id}) is not a submenu`);n.appendMenuItem(e,t)}}else if(void 0!==n){if(!this.contains(n))throw new Error(`parent(id=${n.id}) is not a descendant of the context menu`);n.appendSubmenuItem(e)}else this.appendMenuItem(e)}moveBefore(e,t){let n=e.parentElement;if(!this.contains(n))throw new Error(`parent(id=${n.id}) is not in the contex menu`);if(!this.contains(t))throw new Error(`before(id=${t.id}) is not in the context menu`);n.removeChild(e),this.insertMenuItem(e,{before:t})}moveToSubmenu(e,t=null,n=null){let i=e.parentElement;if(!(i instanceof d))throw new Error(`current parent(id=${i.id}) is not a submenu`);if(!this.contains(i))throw new Error(`parent of the menu item(id=${i.id}) is not in the context menu`);if(null!==t){if(!this.contains(t))throw new Error(`parent(id=${t.id}) is not in the context menu`);i._detachImmediateMenuItem(e),t.appendSubmenuItem(e)}else null!==n&&(e.selector=n.selector,e.coreAsWell=n.coreAsWell),i._detachImmediateMenuItem(e),this.appendMenuItem(e)}ensureDoesntContain(e){let t=document.getElementById(e);if(void 0!==t&&this.contains(t))throw new Error(`There is already an element with id=${e} in the context menu`)}static define(){u("ctx-menu",a,"div")}}function h(e){let t=this;t.scratch("cycontextmenus")||t.scratch("cycontextmenus",{});let n=e=>t.scratch("cycontextmenus")[e],o=(e,n)=>t.scratch("cycontextmenus")[e]=n,u=n("options"),l=n("cxtMenu"),h=e=>{const i=t.container();let s=n("cxtMenuPosition"),u=e.position||e.cyPosition;if(s!=u){l.hideMenuItems(),o("anyVisibleChild",!1),o("cxtMenuPosition",u);let t=function(e){let t=e.getBoundingClientRect();return{top:t.top,left:t.left}}(i),n=e.renderedPosition||e.cyRenderedPosition,s=getComputedStyle(i)["border-width"],r=parseInt(s.replace("px",""))||0;r>0&&(t.top+=r,t.left+=r);let c=i.clientHeight,d=i.clientWidth,a=c/2,h=d/2;n.y>a&&n.x<=h?(l.style.left=n.x+"px",l.style.bottom=c-n.y+"px",l.style.right="auto",l.style.top="auto"):n.y>a&&n.x>h?(l.style.right=d-n.x+"px",l.style.bottom=c-n.y+"px",l.style.left="auto",l.style.top="auto"):n.y<=a&&n.x<=h?(l.style.left=n.x+"px",l.style.top=n.y+"px",l.style.right="auto",l.style.bottom="auto"):(l.style.right=d-n.x+"px",l.style.top=n.y+"px",l.style.left="auto",l.style.bottom="auto")}},m=(e,t)=>{let n=f(e);if(void 0!==t){let e=v(t);l.insertMenuItem(n,{parent:e})}else l.insertMenuItem(n)},p=(e,t)=>{for(let n=0;n<e.length;n++)m(e[n],t)},f=e=>{let n=t.scratch("cycontextmenus");return new c(e,l.onMenuItemClick,n)},b=()=>{n("active")&&(l.removeAllMenuItems(),t.off("tapstart",n("eventCyTapStart")),t.off(u.evtType,n("onCxttap")),t.off("viewport",n("onViewport")),document.body.removeEventListener("mouseup",n("hideOnNonCyClick")),l.parentNode.removeChild(l),l=void 0,o("cxtMenu",void 0),o("active",!1),o("anyVisibleChild",!1),o("onCxttap",void 0),o("onViewport",void 0),o("hideOnNonCyClick",void 0))},y=e=>{let t=document.createElement("img");return t.src=e.src,t.width=e.width,t.height=e.height,t.classList.add("cy-context-menus-submenu-indicator"),t},v=e=>{let t=document.getElementById(e);if(t instanceof c)return t;throw new Error(`The item with id=${e} is not a menu item`)};if("get"!==e){c.define(),d.define(),a.define(),u=function(e,t){let n={};for(let t in e)n[t]=e[t];for(let e in t)n[e]instanceof Array?n[e]=n[e].concat(t[e]):n[e]=t[e];return n}(r,e),o("options",u),n("active")&&b(),o("active",!0),o("submenuIndicatorGen",y.bind(void 0,u.submenuIndicator));let m=s(u.contextMenuClasses);o("cxtMenuClasses",m);let f=()=>o("cxtMenuPosition",void 0),v=t.scratch("cycontextmenus");l=new a(f,v),o("cxtMenu",l),t.container().appendChild(l),o("cxtMenuItemClasses",s(u.menuItemClasses));let x=u.menuItems;p(x),(()=>{let e=e=>{o("currentCyEvent",e),h(e);let s=e.target||e.cyTarget;for(let e of l.children)if(e instanceof c){(s===t?e.coreAsWell:s.is(e.selector))&&e.show&&(l.display(),o("anyVisibleChild",!0),e.display())}!n("anyVisibleChild")&&i(l)&&l.hide()};t.on(u.evtType,e),o("onCxttap",e)})(),(()=>{let e=e=>{if(l.contains(e.originalEvent.target))return!1;l.hide(),o("cxtMenuPosition",void 0),o("currentCyEvent",void 0)};t.on("tapstart",e),o("eventCyTapStart",e);let n=()=>{l.hide()};t.on("viewport",n),o("onViewport",n)})(),(()=>{let e=e=>{t.container().contains(e.target)||l.contains(e.target)||(l.hide(),o("cxtMenuPosition",void 0))};document.addEventListener("mouseup",e),o("hideOnNonCyClick",e)})(),function(){let e=document.getElementsByClassName("cy-context-menus-cxt-menu");for(const t of e)t.addEventListener("contextmenu",e=>e.preventDefault())}()}return(e=>({isActive:function(){return n("active")},appendMenuItem:function(t,n){return m(t,n),e},appendMenuItems:function(t,n){return p(t,n),e},removeMenuItem:function(t){let n=v(t);return l.removeMenuItem(n),e},setTrailingDivider:function(t,n){let i=v(t);return n?i.classList.add("cy-context-menus-divider"):i.classList.remove("cy-context-menus-divider"),e},insertBeforeMenuItem:function(t,n){let i=f(t),s=v(n);return l.insertMenuItem(i,{before:s}),e},moveToSubmenu:function(t,n=null){let i=v(t);if(null===n)l.moveToSubmenu(i);else if("string"==typeof n){let e=v(n.toString());l.moveToSubmenu(i,e)}else void 0!==n.coreAsWell||void 0!==n.selector?l.moveToSubmenu(i,null,n):console.warn("options neither has coreAsWell nor selector property but it is an object. Are you sure that this is what you want to do?");return e},moveBeforeOtherMenuItem:function(t,n){let i=v(t),s=v(n);return l.moveBefore(i,s),e},disableMenuItem:function(t){return v(t).disable(),e},enableMenuItem:function(t){return v(t).enable(),e},hideMenuItem:function(t){return v(t).hide(),e},showMenuItem:function(t){return v(t).display(),e},destroy:function(){return b(),e}}))(this)}}])}));